SELECT Q.QUERY_NAME , 
ROUND(AVG(Q.RATING / Q.POSITION) , 2) AS QUALITY  ,
ROUND(AVG(CASE WHEN Q.RATING < 3 THEN 1 ELSE 0 END) * 100 , 2) AS POOR_QUERY_PERCENTAGE
FROM QUERIES Q
GROUP BY QUERY_NAME